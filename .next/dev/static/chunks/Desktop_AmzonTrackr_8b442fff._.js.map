{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/User/Desktop/AmzonTrackr/components/HeroCarousel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\r\nimport { Carousel } from \"react-responsive-carousel\";\r\nimport Image from \"next/image\";\r\n\r\nconst heroImages = [\r\n  { imgUrl: \"/assets/images/hero-1.svg\", alt: \"smartwatch\" },\r\n  { imgUrl: \"/assets/images/hero-2.svg\", alt: \"bag\" },\r\n  { imgUrl: \"/assets/images/hero-3.svg\", alt: \"lamp\" },\r\n  { imgUrl: \"/assets/images/hero-4.svg\", alt: \"air fryer\" },\r\n  { imgUrl: \"/assets/images/hero-5.svg\", alt: \"chair\" },\r\n];\r\n\r\nconst HeroCarousel = () => {\r\n  return (\r\n    <div className=\"hero-carousel\">\r\n      <Carousel\r\n        showThumbs={false}\r\n        autoPlay\r\n        infiniteLoop\r\n        interval={2000}\r\n        showArrows={false}\r\n        showStatus={false}\r\n      >\r\n        {heroImages.map((image) => (\r\n          <Image\r\n            src={image.imgUrl}\r\n            alt={image.alt}\r\n            width={484}\r\n            height={484}\r\n            className=\"object-contain\"\r\n            key={image.alt}\r\n          />\r\n        ))}\r\n      </Carousel>\r\n\r\n      <Image\r\n        src=\"assets/icons/hand-drawn-arrow.svg\"\r\n        alt=\"arrow\"\r\n        width={175}\r\n        height={175}\r\n        className=\"max-xl:hidden absolute -left-[15%] bottom-0 z-0\"\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HeroCarousel;\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;;AAMA,MAAM,aAAa;IACjB;QAAE,QAAQ;QAA6B,KAAK;IAAa;IACzD;QAAE,QAAQ;QAA6B,KAAK;IAAM;IAClD;QAAE,QAAQ;QAA6B,KAAK;IAAO;IACnD;QAAE,QAAQ;QAA6B,KAAK;IAAY;IACxD;QAAE,QAAQ;QAA6B,KAAK;IAAQ;CACrD;AAED,MAAM,eAAe;IACnB,qBACE,uNAAC;QAAI,WAAU;;0BACb,uNAAC,8MAAQ;gBACP,YAAY;gBACZ,QAAQ;gBACR,YAAY;gBACZ,UAAU;gBACV,YAAY;gBACZ,YAAY;0BAEX,WAAW,GAAG,CAAC,CAAC,sBACf,uNAAC,qKAAK;wBACJ,KAAK,MAAM,MAAM;wBACjB,KAAK,MAAM,GAAG;wBACd,OAAO;wBACP,QAAQ;wBACR,WAAU;uBACL,MAAM,GAAG;;;;;;;;;;0BAKpB,uNAAC,qKAAK;gBACJ,KAAI;gBACJ,KAAI;gBACJ,OAAO;gBACP,QAAQ;gBACR,WAAU;;;;;;;;;;;;AAIlB;KAhCM;uCAkCS"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/User/Desktop/AmzonTrackr/lib/actions/index.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { revalidatePath } from \"next/cache\";\r\nimport Product from \"../models/product.model\";\r\nimport { connectToDB } from \"../mongoose\";\r\nimport { scrapeAmazonProduct } from \"../scraper\";\r\nimport { getAveragePrice, getHighestPrice, getLowestPrice } from \"../utils\";\r\nimport { User } from \"@/types\";\r\nimport { generateEmailBody, sendEmail } from \"../nodemailer\";\r\n\r\nexport async function scrapeAndStoreProduct(productUrl: string) {\r\n  if(!productUrl) return;\r\n\r\n  try {\r\n    await connectToDB();\r\n\r\n    const scrapedProduct = await scrapeAmazonProduct(productUrl);\r\n\r\n    if(!scrapedProduct) return;\r\n\r\n    let product = scrapedProduct;\r\n\r\n    const existingProduct = await Product.findOne({ url: scrapedProduct.url });\r\n\r\n    if(existingProduct) {\r\n      const updatedPriceHistory: any = [\r\n        ...existingProduct.priceHistory,\r\n        { price: scrapedProduct.currentPrice }\r\n      ]\r\n\r\n      product = {\r\n        ...scrapedProduct,\r\n        priceHistory: updatedPriceHistory,\r\n        lowestPrice: getLowestPrice(updatedPriceHistory),\r\n        highestPrice: getHighestPrice(updatedPriceHistory),\r\n        averagePrice: getAveragePrice(updatedPriceHistory),\r\n      }\r\n    }\r\n\r\n    const newProduct = await Product.findOneAndUpdate(\r\n      { url: scrapedProduct.url },\r\n      product,\r\n      { upsert: true, new: true }\r\n    );\r\n\r\n    revalidatePath(`/products/${newProduct._id}`);\r\n    return newProduct; // Return the new or updated product\r\n  } catch (error: any) {\r\n    throw new Error(`Failed to create/update product: ${error.message}`)\r\n  }\r\n}\r\n\r\nexport async function getProductById(productId: string) {\r\n  try {\r\n    await connectToDB();\r\n\r\n    const product = await Product.findOne({ _id: productId });\r\n\r\n    if(!product) return null;\r\n\r\n    return product;\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport async function getAllProducts() {\r\n  try {\r\n    await connectToDB();\r\n\r\n    const products = await Product.find();\r\n\r\n    return products;\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport async function getSimilarProducts(productId: string) {\r\n  try {\r\n    await connectToDB();\r\n\r\n    const currentProduct = await Product.findById(productId);\r\n\r\n    if(!currentProduct) return null;\r\n\r\n    const similarProducts = await Product.find({\r\n      _id: { $ne: productId },\r\n    }).limit(3);\r\n\r\n    return similarProducts;\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport async function addUserEmailToProduct(productId: string, userEmail: string) {\r\n  try {\r\n    await connectToDB();\r\n\r\n    const product = await Product.findById(productId);\r\n\r\n    if(!product) return;\r\n\r\n    const userExists = product.users.some((user: User) => user.email === userEmail);\r\n\r\n    if(!userExists) {\r\n      product.users.push({ email: userEmail });\r\n\r\n      await product.save();\r\n\r\n      const emailContent = await generateEmailBody(product, \"WELCOME\");\r\n\r\n      await sendEmail(emailContent, [userEmail]);\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}"],"names":[],"mappings":";;;;;;;IAUsB,wBAAA,WAAA,GAAA,IAAA,4QAAA,EAAA,8CAAA,iQAAA,EAAA,KAAA,GAAA,uQAAA,EAAA"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///c:/Users/User/Desktop/AmzonTrackr/components/Searchbar.tsx"],"sourcesContent":["\"use client\";\r\nimport Link from \"next/link\";\r\nimport { scrapeAndStoreProduct } from \"@/lib/actions\";\r\nimport { FormEvent, useState, useEffect } from \"react\";\r\n\r\nconst isValidAmazonProductURL = (url: string) => {\r\n  try {\r\n    const parsedURL = new URL(url);\r\n    const hostname = parsedURL.hostname;\r\n\r\n    if (\r\n      hostname.includes(\"amazon.com\") ||\r\n      hostname.includes(\"amazon.\") ||\r\n      hostname.endsWith(\"amazon\")\r\n    ) {\r\n      return true;\r\n    }\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nconst Searchbar = () => {\r\n  const [searchPrompt, setSearchPrompt] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [productId, setProductId] = useState<string | null>(null);\r\n  const [placeholder, setPlaceholder] = useState(\"\");\r\n  const fullPlaceholder =\r\n    \"Paste your amazon link here (e.g., https://www.amazon.com/example)\";\r\n  const [index, setIndex] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const typewriterEffect = () => {\r\n      if (index < fullPlaceholder.length) {\r\n        setPlaceholder((prev) => prev + fullPlaceholder[index]);\r\n        setIndex(index + 1);\r\n      } else {\r\n        setTimeout(() => {\r\n          setPlaceholder(\"\");\r\n          setIndex(0);\r\n        }, 2000);\r\n      }\r\n    };\r\n\r\n    const timer = setTimeout(typewriterEffect, 90);\r\n    return () => clearTimeout(timer);\r\n  }, [index, fullPlaceholder]);\r\n\r\n  const handleSubmit = async (event: FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n\r\n    const isValidLink = isValidAmazonProductURL(searchPrompt);\r\n\r\n    if (!isValidLink) return alert(\"Please provide a valid Amazon link\");\r\n\r\n    try {\r\n      setIsLoading(true);\r\n\r\n      // Scrape the product page\r\n      const product = await scrapeAndStoreProduct(searchPrompt);\r\n      if (product?._id) {\r\n        setProductId(product._id);\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form className=\"flex flex-wrap gap-4 mt-12\" onSubmit={handleSubmit}>\r\n      <input\r\n        type=\"text\"\r\n        value={searchPrompt}\r\n        onChange={(e) => setSearchPrompt(e.target.value)}\r\n        placeholder={placeholder}\r\n        className=\"searchbar-input\"\r\n      />\r\n\r\n      <button\r\n        type=\"submit\"\r\n        className=\"searchbar-btn\"\r\n        disabled={searchPrompt === \"\"}\r\n      >\r\n        {isLoading ? \"Searching...\" : \"Search\"}\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Searchbar;\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAKA,MAAM,0BAA0B,CAAC;IAC/B,IAAI;QACF,MAAM,YAAY,IAAI,IAAI;QAC1B,MAAM,WAAW,UAAU,QAAQ;QAEnC,IACE,SAAS,QAAQ,CAAC,iBAClB,SAAS,QAAQ,CAAC,cAClB,SAAS,QAAQ,CAAC,WAClB;YACA,OAAO;QACT;IACF,EAAE,OAAO,OAAO;QACd,OAAO;IACT;IAEA,OAAO;AACT;AAEA,MAAM,YAAY;;IAChB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,mMAAQ,EAAC;IACjD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,mMAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,mMAAQ,EAAgB;IAC1D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,mMAAQ,EAAC;IAC/C,MAAM,kBACJ;IACF,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,mMAAQ,EAAC;IAEnC,IAAA,oMAAS;+BAAC;YACR,MAAM;wDAAmB;oBACvB,IAAI,QAAQ,gBAAgB,MAAM,EAAE;wBAClC;oEAAe,CAAC,OAAS,OAAO,eAAe,CAAC,MAAM;;wBACtD,SAAS,QAAQ;oBACnB,OAAO;wBACL;oEAAW;gCACT,eAAe;gCACf,SAAS;4BACX;mEAAG;oBACL;gBACF;;YAEA,MAAM,QAAQ,WAAW,kBAAkB;YAC3C;uCAAO,IAAM,aAAa;;QAC5B;8BAAG;QAAC;QAAO;KAAgB;IAE3B,MAAM,eAAe,OAAO;QAC1B,MAAM,cAAc;QAEpB,MAAM,cAAc,wBAAwB;QAE5C,IAAI,CAAC,aAAa,OAAO,MAAM;QAE/B,IAAI;YACF,aAAa;YAEb,0BAA0B;YAC1B,MAAM,UAAU,MAAM,IAAA,4MAAqB,EAAC;YAC5C,IAAI,SAAS,KAAK;gBAChB,aAAa,QAAQ,GAAG;YAC1B;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,GAAG,CAAC;QACd,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,uNAAC;QAAK,WAAU;QAA6B,UAAU;;0BACrD,uNAAC;gBACC,MAAK;gBACL,OAAO;gBACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;gBAC/C,aAAa;gBACb,WAAU;;;;;;0BAGZ,uNAAC;gBACC,MAAK;gBACL,WAAU;gBACV,UAAU,iBAAiB;0BAE1B,YAAY,iBAAiB;;;;;;;;;;;;AAItC;GAnEM;KAAA;uCAqES"}}]
}